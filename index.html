<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <title>PolyglotPal ‚Äì Instant Text Translator</title>
  <meta name="description" content="PolyglotPal: translate text instantly between 100+ languages, save phrases, listen pronunciation, import/export history, copy or download‚Äîall client-side.">
  <meta name="keywords" content="text translation, client-side translator, Web Speech API, history export, language learning">
  <meta name="author" content="Bocaletto Luca"/>
  <link rel="canonical" href="https://github.com/bocaletto-luca/PolyglotPal"/>
  <meta property="og:title" content="PolyglotPal ‚Äì Instant Text Translator"/>
  <meta property="og:description" content="Translate text instantly between 100+ languages with history import/export and speech synthesis."/>
  <meta property="og:url" content="https://github.com/bocaletto-luca/PolyglotPal"/>
  <meta property="og:type" content="website"/>
  <script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "WebApplication",
    "name": "PolyglotPal",
    "url": "https://github.com/bocaletto-luca/PolyglotPal",
    "applicationCategory": "Translation",
    "description": "Translate text instantly between 100+ languages, save history, import/export, and speech synthesis."
  }
  </script>
  <style>
    :root {
      --bg: #f4f4f4; --fg: #333; --card: #fff;
      --primary: #0066cc; --primary-dark: #004a99;
      --accent: #28a745; --accent-dark: #1e7e34;
      --border: #ccc;
    }
    [data-theme="dark"] {
      --bg: #1e1e1e; --fg: #eee; --card: #2c2c2c;
      --primary: #339af0; --primary-dark: #1c7ed6;
      --accent: #5cb85c; --accent-dark: #4cae4c;
      --border: #555;
    }
    * { box-sizing:border-box; margin:0; padding:0; }
    body {
      font-family:Arial,sans-serif;
      background:var(--bg); color:var(--fg);
      display:flex; flex-direction:column; min-height:100vh;
    }
    header, footer {
      background:var(--primary); color:#fff;
      text-align:center; padding:1rem;
    }
    footer a { color:#fff; text-decoration:underline }
    main {
      flex:1; max-width:900px; margin:1rem auto; padding:1rem;
    }
    .row {
      display:flex; flex-wrap:wrap; gap:.5rem; margin-bottom:1rem;
    }
    select, button, textarea {
      font-size:1rem; border:1px solid var(--border);
      border-radius:4px; padding:.5rem;
      background:var(--card); color:var(--fg);
    }
    select, textarea { flex:1 }
    button {
      background:var(--accent); color:#fff; border:none;
      cursor:pointer; transition:background .2s;
    }
    button:hover { background:var(--accent-dark) }
    .swap-btn { background:var(--primary) }
    .swap-btn:hover { background:var(--primary-dark) }
    textarea { width:100%; min-height:100px; resize:vertical; }
    .actions {
      display:flex; flex-wrap:wrap; gap:.5rem; margin-top:.5rem;
    }
    .actions button { background:var(--primary) }
    .actions button:hover { background:var(--primary-dark) }
    .section {
      background:var(--card);
      border:1px solid var(--border);
      border-radius:6px;
      padding:1rem;
      margin-bottom:1rem;
    }
    .section h2 {
      margin-bottom:.5rem;
      font-size:1.2rem;
      display:flex;
      align-items:center;
      gap:.5rem;
    }
    .section h2 button {
      font-size:.85rem;
      background:var(--accent);
      color:#fff;
      border:none;
      padding:.25rem .5rem;
      border-radius:4px;
      cursor:pointer;
      transition:background .2s;
    }
    .section h2 button:hover { background:var(--accent-dark) }
    ul { list-style:none; padding:0; margin:0; }
    li {
      display:flex; justify-content:space-between;
      align-items:center; padding:.4rem;
      border-bottom:1px solid var(--border);
    }
    li:last-child { border-bottom:none }
    .hist-text { flex:1; cursor:pointer }
    .star-btn {
      background:transparent; color:var(--accent);
      font-size:1.1rem; border:none; cursor:pointer;
    }
    @media(max-width:600px){
      .row { flex-direction:column }
      .actions { flex-direction:column }
      .section h2 { flex-direction:column; align-items:flex-start }
    }
  </style>
</head>
<body data-theme="light">
  <header>
    <h1>PolyglotPal</h1>
    <p>Translate text instantly between 100+ languages</p>
  </header>

  <main>
    <!-- Translator UI -->
    <div class="section">
      <div class="row">
        <select id="srcLang"></select>
        <button id="swapBtn" class="swap-btn">‚ÜîÔ∏è Swap</button>
        <select id="tgtLang"></select>
      </div>
      <div class="row">
        <textarea id="srcText" placeholder="Type text here‚Ä¶"></textarea>
      </div>
      <div class="row">
        <button id="transBtn">Translate</button>
      </div>
      <div class="row">
        <textarea id="tgtText" readonly placeholder="Translated text‚Ä¶"></textarea>
      </div>
      <div class="actions">
        <button id="speakBtn">üîä Speak</button>
        <button id="copyBtn">üìã Copy</button>
        <button id="downloadBtn">‚¨áÔ∏è Download .txt</button>
        <button id="favBtn" class="star-btn">‚òÜ Favorite</button>
        <button id="themeBtn">üåô Dark Mode</button>
      </div>
    </div>

    <!-- History -->
    <div class="section">
      <h2>
        History
        <button id="exportHist">Export</button>
        <button id="importHist">Import</button>
        <button id="clearHist">Clear</button>
        <input type="file" id="importHistInput" accept=".json" hidden/>
      </h2>
      <ul id="historyList"></ul>
    </div>

    <!-- Favorites -->
    <div class="section">
      <h2>Favorites</h2>
      <ul id="favList"></ul>
    </div>
  </main>

  <footer>
    ¬© 2025 Bocaletto Luca ‚Äì 
    <a href="https://github.com/bocaletto-luca/PolyglotPal" target="_blank">Repository</a>
  </footer>

  <script>
  (function(){
    const API_URL = 'https://api.mymemory.translated.net/get';
    const LANGS = {
      en:'English', es:'Spanish', fr:'French', de:'German',
      it:'Italian', pt:'Portuguese', ru:'Russian', ja:'Japanese',
      zh:'Chinese', ar:'Arabic', ko:'Korean', nl:'Dutch',
      sv:'Swedish', hi:'Hindi', vi:'Vietnamese',
      id:'Indonesian', tr:'Turkish'
    };

    // UI references
    const srcSel   = document.getElementById('srcLang');
    const tgtSel   = document.getElementById('tgtLang');
    const srcTa    = document.getElementById('srcText');
    const tgtTa    = document.getElementById('tgtText');
    const swapBtn  = document.getElementById('swapBtn');
    const transBtn = document.getElementById('transBtn');
    const speakBtn = document.getElementById('speakBtn');
    const copyBtn  = document.getElementById('copyBtn');
    const downBtn  = document.getElementById('downloadBtn');
    const favBtn   = document.getElementById('favBtn');
    const themeBtn = document.getElementById('themeBtn');
    const exportHistBtn = document.getElementById('exportHist');
    const importHistBtn = document.getElementById('importHist');
    const clearHistBtn  = document.getElementById('clearHist');
    const importHistInput = document.getElementById('importHistInput');
    const histUL   = document.getElementById('historyList');
    const favUL    = document.getElementById('favList');
    const body     = document.body;

    // Persistent state
    let state = JSON.parse(localStorage.getItem('polyglotpal') || '{"history":[],"favorites":[]}');
    function saveState(){ localStorage.setItem('polyglotpal', JSON.stringify(state)); }

    // Populate language selectors
    Object.entries(LANGS).forEach(([code,name])=>{
      srcSel.add(new Option(name,code));
      tgtSel.add(new Option(name,code));
    });
    srcSel.value='en'; tgtSel.value='es';

    // Swap languages & text
    swapBtn.onclick = ()=>{
      [srcSel.value,tgtSel.value]=[tgtSel.value,srcSel.value];
      [srcTa.value,tgtTa.value]=[tgtTa.value,srcTa.value];
    };

    // Translate
    transBtn.onclick = async ()=>{
      const text = srcTa.value.trim();
      if(!text) return;
      transBtn.disabled=true;
      tgtTa.value='Translating‚Ä¶';
      try {
        const url = `${API_URL}?q=${encodeURIComponent(text)}&langpair=${srcSel.value}|${tgtSel.value}`;
        const res = await fetch(url);
        const json = await res.json();
        const translated = json.responseData.translatedText;
        tgtTa.value = translated;
        addHistory(text,translated);
      } catch(err) {
        console.error(err);
        tgtTa.value = 'Error during translation';
      }
      transBtn.disabled=false;
    };

    // History & Favorites
    function addHistory(src,tgt){
      const entry = {src,tgt,s:srcSel.value,t:tgtSel.value,ts:Date.now()};
      state.history.unshift(entry);
      if(state.history.length>50) state.history.pop();
      saveState(); renderHistory();
    }
    function isFav(e){ return state.favorites.some(f=>f.ts===e.ts); }
    function toggleFav(e){
      if(isFav(e)) state.favorites = state.favorites.filter(f=>f.ts!==e.ts);
      else state.favorites.unshift(e);
      saveState();
    }
    function renderHistory(){
      histUL.innerHTML='';
      state.history.forEach(e=>{
        const li=document.createElement('li');
        li.innerHTML=`<span class="hist-text">${e.src} ‚Üí ${e.tgt}</span>
                      <button class="star-btn">${isFav(e)?'‚òÖ':'‚òÜ'}</button>`;
        li.querySelector('.hist-text').onclick=()=>{
          srcTa.value=e.src; tgtTa.value=e.tgt;
          srcSel.value=e.s; tgtSel.value=e.t;
        };
        li.querySelector('.star-btn').onclick=()=>{
          toggleFav(e);
          renderHistory(); renderFavorites();
        };
        histUL.appendChild(li);
      });
    }
    function renderFavorites(){
      favUL.innerHTML='';
      state.favorites.forEach(e=>{
        const li=document.createElement('li');
        li.innerHTML=`<span class="hist-text">${e.src} ‚Üí ${e.tgt}</span>
                      <button class="star-btn">‚òÖ</button>`;
        li.querySelector('.hist-text').onclick=()=>{
          srcTa.value=e.src; tgtTa.value=e.tgt;
          srcSel.value=e.s; tgtSel.value=e.t;
        };
        li.querySelector('.star-btn').onclick=()=>{
          toggleFav(e);
          renderHistory(); renderFavorites();
        };
        favUL.appendChild(li);
      });
    }

    // Export History
    exportHistBtn.onclick = ()=>{
      const blob = new Blob([JSON.stringify(state.history,null,2)],{type:'application/json'});
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = 'polyglotpal-history.json';
      a.click();
      URL.revokeObjectURL(a.href);
    };
    // Import History
    importHistBtn.onclick = ()=> importHistInput.click();
    importHistInput.onchange = e=>{
      const file = e.target.files[0];
      if(!file) return;
      const r = new FileReader();
      r.onload = ()=>{
        try{
          const arr = JSON.parse(r.result);
          if(!Array.isArray(arr)) throw '';
          state.history = arr;
          saveState(); renderHistory();
          alert('History imported');
        } catch{
          alert('Invalid history file');
        }
      };
      r.readAsText(file);
      importHistInput.value='';
    };
    // Clear History
    clearHistBtn.onclick = ()=>{
      if(confirm('Delete all history?')) {
        state.history = [];
        saveState(); renderHistory();
      }
    };

    // Speech Synthesis
    let voices = [];
    function loadVoices(){
      voices = speechSynthesis.getVoices();
      if(!voices.length) setTimeout(loadVoices,200);
    }
    speechSynthesis.onvoiceschanged = loadVoices;
    loadVoices();

    speakBtn.onclick = ()=>{
      const txt = tgtTa.value.trim();
      if(!txt) return alert('Nothing to speak');
      if(speechSynthesis.speaking) speechSynthesis.cancel();
      const u = new SpeechSynthesisUtterance(txt);
      u.lang = tgtSel.value;
      const match = voices.find(v=>v.lang.toLowerCase().startsWith(tgtSel.value.toLowerCase()));
      if(match) u.voice = match;
      speechSynthesis.speak(u);
    };

    // Copy
    copyBtn.onclick = async ()=>{
      try{ await navigator.clipboard.writeText(tgtTa.value); alert('Copied to clipboard'); }
      catch{ alert('Copy failed'); }
    };
    // Download
    downBtn.onclick = ()=>{
      const blob = new Blob([
        `Original (${srcSel.value}):\n${srcTa.value}\n\n`,
        `Translated (${tgtSel.value}):\n${tgtTa.value}`
      ],{type:'text/plain'});
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = 'translation.txt';
      a.click();
      URL.revokeObjectURL(a.href);
    };
    // Favorite current
    favBtn.onclick = ()=>{
      const entry = {src:srcTa.value,tgt:tgtTa.value,s:srcSel.value,t:tgtSel.value,ts:Date.now()};
      toggleFav(entry); renderHistory(); renderFavorites();
    };
    // Theme toggle
    themeBtn.onclick = ()=>{
      const next = body.dataset.theme==='light'?'dark':'light';
      body.dataset.theme = next;
      themeBtn.textContent = next==='dark'?'‚òÄÔ∏è Light Mode':'üåô Dark Mode';
    };
    // Enter ‚Üí translate
    srcTa.addEventListener('keydown', e=>{
      if(e.key==='Enter'&&!e.shiftKey){
        e.preventDefault(); transBtn.click();
      }
    });

    // Initialize
    renderHistory(); renderFavorites();
  })();
  </script>
</body>
</html>
